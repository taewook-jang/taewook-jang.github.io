---
layout: post
title: Android 윈도우(Overlay) 권한 획득하기
categories: [AndroidDev]
tags: [Android Overlay, Android]
fullview: false
comments: true
published: false
---

<br />

## Overlay 권한 사용으로 인한 문제



대략 Overlay을 사용하는 앱들은 다음과 같을 것 같습니다.

- 전역 적으로 서비스를 제공하기 위한 앱(페이스북, 녹화 등)
- 색상 필터를 제공하기 위한 앱
- 앱 내에서 Overlay을 사용하기 위한 앱

위와 같은 앱들이 Overlay을 사용하게 됩니다.

이때 6.0 이상에서는 다음과 같은 일이 발생합니다.

- **다른 앱의 권한 설정이 불가능해집니다.**
- **쉐도우처리된 배경 색이 보이지 않습니다.**

첫 번째의 다른 앱 권한 설정이 불가능 해진다는 부분은 다음과 같습니다.

사용자의 동의를 얻어야 하는 권한(아래에서는 위치 정보)에서 동의를 눌렀을 경우 오른쪽 그림과 같이 Overlay detected라는 명령이 포함됩니다. 권한 설정하는 앱에 따라서 앱 사용이 불가능합니다.

![2016-05-08 03.47.00](/images/2016/2016-05-08-Android-Overlay-Permission/2016-05-08 03.47.00.png)

<hr>

활성화하기 위해서는 Overlay에 대한 설정을 변경 처리해주어야 하는데 사용자가 어느 앱에서 이러한 문제가 발생하고 있는지 알기는 어렵습니다.

**저 또한 저 창이 떠서 재부팅을 하기도 하였습니다.**

다만 저 창이 뜨는 것은 오류가 아닙니다. 사용자를 위해서 개발자가 주의하여 Overlay을 사용해 주어야 한다는 점입니다.(구글이 해주어야 하는데...)

**두 번째 사항인 쉐도우 처리** 부분을 다음과 같이 확인할 수 있습니다.

확연하게 다른 부분입니다. 바로 AlertDialog에서 반투명 배경이 들어갔을 때와 들어가지 않았을 때입니다.

개발 중에도 쉐도우 처리가 보이지 않을 수 있으니 주의해야겠습니다.

![2016-05-08 03.54.20](/images/2016/2016-05-08-Android-Overlay-Permission/2016-05-08 03.54.20.png)

이런 점이 6.0 Marshmallow 이상에서 적용될 사항으로 주의하여 개발이 필요합니다.

우선 6.0 대응을 위한 부분을 작성하였습니다.
